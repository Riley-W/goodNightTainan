(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b000616"],{1971:function(e,t,s){},"3e0d":function(e,t,s){"use strict";s("9ca9")},"9ca9":function(e,t,s){},bb51:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("FrontNavbar",{attrs:{isMember:e.isMember}}),s("div",{staticClass:"container-fuild"},[s("loading",{attrs:{active:e.isLoading,loader:"spinner",color:e.loader.color,width:e.loader.width,height:e.loader.height,"lock-scroll":e.loader.lockScroll,"is-full-page":e.loader.isFullPage}}),s("section",{staticClass:"container-fuild"},[s("div",{staticClass:"banner d-flex align-items-center"},[s("div",{staticClass:"container mb-0 mt-3 mb-md-4"},[s("h1",{staticClass:"text-primary fw-bold"},[e._v("好夜台南")]),s("p",{staticClass:"fs-3 text-primary"},[e._v("美好夜晚，盡在台南")]),s("router-link",{staticClass:"btn btn-light me-3",attrs:{to:"/shops/all"}},[e._v(" 更多內容 "),s("span",{staticClass:"material-icons align-middle fs-6"},[e._v(" arrow_forward ")])])],1)])]),s("section",{staticClass:"container-fuild py-6"},[s("div",{staticClass:"container"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col height-50"},[s("h2",{staticClass:"text-dark text-center fw-bold mb-3"},[e._v("地圖查詢")]),s("LeafletComponent")],1)])])]),s("section",{staticClass:"container-fuild bg-dark py-6"},[s("div",{staticClass:"container"},[s("h2",{staticClass:"text-center text-primary mb-3"},[e._v("熱門商家")]),s("Swiper",{attrs:{"member-id":e.review.MemberID},on:{"open-modal":e.openRouteModal}})],1)]),s("section",{staticClass:"container py-6",attrs:{id:"review"}},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-10 col-md-6 col-lg-5"},[s("h3",{staticClass:"h2 text-center"},[e._v("意見回饋")]),e.isMember?s("form",{ref:"form",attrs:{action:"#"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.review.MemberID,expression:"review.MemberID"}],attrs:{type:"hidden",name:"memberID",id:"memberID"},domProps:{value:e.review.MemberID},on:{input:function(t){t.target.composing||e.$set(e.review,"MemberID",t.target.value)}}}),s("div",{staticClass:"mb-3"},[s("label",{staticClass:"form-label",attrs:{for:"memberEmail"}},[e._v("會員名稱")]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.memberName,expression:"memberName"}],staticClass:"form-control",attrs:{type:"text",id:"memberAccount",name:"memberAccount",disabled:""},domProps:{value:e.memberName},on:{input:function(t){t.target.composing||(e.memberName=t.target.value)}}})]),s("div",{staticClass:"mb-3"},[s("label",{staticClass:"form-label",attrs:{for:"type"}},[e._v("類別")]),s("span",{staticClass:"text-danger ms-2"},[e._v("必填")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.review.Type,expression:"review.Type"}],staticClass:"form-select",attrs:{name:"type",id:"type"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.review,"Type",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"",disabled:"",selected:""}},[e._v("請選擇類別")]),s("option",{attrs:{value:"推薦商家"}},[e._v("推薦商家")]),s("option",{attrs:{value:"店家資訊更新"}},[e._v("店家資訊更新")]),s("option",{attrs:{value:"系統回饋"}},[e._v("系統錯誤回饋")]),s("option",{attrs:{value:"其他"}},[e._v("其他")])])]),s("div",{staticClass:"mb-3"},[s("label",{staticClass:"form-label",attrs:{for:"reviewContent"}},[e._v("留言")]),s("span",{staticClass:"text-danger ms-2"},[e._v("必填")]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.review.RContent,expression:"review.RContent"}],staticClass:"form-control",attrs:{name:"reviewContent",id:"reviewContent",cols:"20",rows:"5"},domProps:{value:e.review.RContent},on:{input:function(t){t.target.composing||e.$set(e.review,"RContent",t.target.value)}}})]),s("div",{staticClass:"form-floating mb-3 text-center"},[s("button",{staticClass:"btn btn-primary btn-lg w-25",attrs:{type:"submit",disabled:e.isDisabled},on:{click:function(t){return t.preventDefault(),e.addWebsiteReview.apply(null,arguments)}}},[e._v(" 送出 "),e.isDisabled?s("span",{staticClass:"spinner-grow spinner-grow-sm"}):e._e()])])]):s("div",{staticClass:"d-flex flex-column align-items-center"},[s("h5",[e._v("登入即可留言")]),s("router-link",{staticClass:"btn btn-primary text-center",attrs:{to:"/memberlogin"}},[e._v("按此登入")])],1)])])])],1),s("FrontFooter"),s("Roulette",{ref:"modal"}),s("RouteModal",{ref:"routeModal",attrs:{routes:e.memberRoutes,titles:e.memberRouteTitles,"shop-id":e.shopId},on:{"get-routes":e.getRoutes}})],1)},o=[],a=(s("99af"),s("ac1f"),s("5319"),s("d3b7"),s("159b"),s("b0c9")),r=s("d08d"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("l-map",{staticStyle:{height:"500px",width:"100%"},attrs:{zoom:e.zoom,center:e.center}},[s("l-control-layers",{attrs:{position:"topright"}}),e._l(e.tileProviders,(function(e){return s("l-tile-layer",{key:e.name,attrs:{name:e.name,visible:e.visible,url:e.url,attribution:e.attribution,"layer-type":"base"}})})),e._l(e.markers,(function(t,i){return s("l-marker",{key:i,attrs:{"lat-lng":t.point,icon:t.icon}},[s("l-popup",[e._v(" "+e._s(t.shopName)+" "),s("router-link",{attrs:{to:"shops/shop/"+t.shopID}},[e._v(" 點擊查看店家 ")])],1)],1)}))],2)],1)},c=[],l=s("e11e"),m=s("2699"),p=s("a40a"),u=s("4e2b"),h=s("f60f"),d=s("9ee8"),b={name:"CustomPath",components:{LMap:m["a"],LTileLayer:p["a"],LMarker:u["a"],LPopup:h["a"],LControlLayers:d["a"]},data:function(){return{tileProviders:[{name:"OpenStreetMap",visible:!1,attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"OpenDarkMap",visible:!0,url:"https://{s}.tile.jawg.io/jawg-matrix/{z}/{x}/{y}{r}.png?access-token=15IcrzrfcUzGjoEPHByJUZl9BP5KL0eCqCUBvNXbqbkfEUPKwewonYHQX7NXx80B",attribution:'<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> <a href="https://www.openstreetmap.org/copyright"> &copyOpenStreetMap</a>'}],zoom:13,path:"http://leafletjs.com/examples/custom-icons/leaf-green.png",center:[22.996,120.2],url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",iconAll:Object(l["icon"])({iconUrl:"marker.svg",iconSize:[50,50]}),iconBar:Object(l["icon"])({iconUrl:"barMarker.svg",iconSize:[50,50]}),iconNightView:Object(l["icon"])({iconUrl:"nightMarker.svg",iconSize:[50,50]}),iconDessert:Object(l["icon"])({iconUrl:"dessertMarker.svg",iconSize:[50,50]}),iconSnack:Object(l["icon"])({iconUrl:"snackMarker.svg",iconSize:[50,50]}),markers:[],barMarkers:[],shops:[],bars:[]}},methods:{getPoints:function(){var e=this,t="".concat("https://localhost:44333","/api/ShopInfoes");this.$http.get(t).then((function(t){console.log(t),e.shops=t.data,e.shops.forEach((function(t){var s=t.ShopID,i=t.Name,o=Object(l["latLng"])(t.Latitude,t.Longitude),a=e.iconBar;"酒吧"===t.Type?a=e.iconBar:"咖啡甜點"===t.Type?a=e.iconDessert:"夜間景點"===t.Type?a=e.iconNightView:"小吃宵夜"===t.Type&&(a=e.iconSnack),e.markers.push({point:o,shopID:s,shopName:i,icon:a})}))})).catch((function(e){console.dir(e)}))}},mounted:function(){this.getPoints()}},v=b,f=s("2877"),g=Object(f["a"])(v,n,c,!1,null,null,null),w=g.exports,C=s("46a5"),y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("swiper",{attrs:{options:e.swiperOption}},e._l(e.shops,(function(t){return s("swiper-slide",{key:t.ShopID,staticClass:"rounded-5 border-primary border-2"},[t.Enable?s("div",{key:t.ShopID,staticClass:"mb-4"},[s("div",{staticClass:"card border-primary rounded-lg w-100 overflow-hidden"},[s("div",{staticClass:"position-relative"},[s("a",{staticClass:"card-icon bg-transparent lh-sm",attrs:{href:"#"}},[e.memberFavorites.includes(t.ShopID)?s("span",{staticClass:"card-icon-istrue material-icons",on:{click:function(s){return s.preventDefault(),e.removeFavorite(t.ShopID)}}},[e._v(" favorite ")]):s("span",{staticClass:"material-icons",on:{click:function(s){return s.preventDefault(),e.addFavorite(t.ShopID)}}},[e._v(" favorite ")])]),s("p",{staticClass:"card-browse"},[s("span",{staticClass:"material-icons me-2"},[e._v(" visibility ")]),s("span",[e._v(e._s(t.Click))])]),s("div",{staticClass:"card-img bg-primary",style:{backgroundImage:"url("+t.Image1+")"}})]),s("div",{staticClass:"card-body"},[s("h5",{staticClass:"card-title fs-5 fw-bold d-flex align-items-center"},[e._v(" "+e._s(t.Name)+" ")]),s("div",{staticClass:"mb-3"},e._l(t.tags,(function(t){return s("span",{key:t,staticClass:"fs-7 fw-light badge bg-info me-1 lh-sm"},[e._v(e._s(t))])})),0),s("ul",{staticClass:"list-unstyled"},[s("li",[e._v("地址："+e._s(t.Address))]),s("li",[e._v("低消："+e._s(t.Min))])])]),s("div",{staticClass:"card-footer bg-transparent border-0"},[s("div",{staticClass:"d-flex"},[s("a",{staticClass:"btn btn-outline-info bg-transparnt d-flex align-items-center lh-base me-3",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.addRoulette(t.ShopID,t.Name)}}},[s("span",{staticClass:"material-icons fs-6 me-1"},[e._v("add")]),e._v("加入輪盤 ")]),s("a",{staticClass:"btn btn-outline-primary bg-transparnt d-flex align-items-center lh-base",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.openRouteModal(t.ShopID)}}},[s("span",{staticClass:"material-icons fs-6 me-1"},[e._v("add")]),e._v("加入行程 ")])])]),s("div",{staticClass:"card-footer bg-primary"},[s("router-link",{staticClass:"fs-4 text-center text-dark",attrs:{to:"/shops/shop/"+t.ShopID}},[e._v("查看更多")])],1)])]):e._e()])})),1)],1)},I=[],_=(s("4de4"),s("1276"),s("caad"),s("2532"),s("a9e3"),s("a434"),s("b64b"),s("7212")),M=(s("a7a3"),{props:["memberId"],components:{Swiper:_["Swiper"],SwiperSlide:_["SwiperSlide"]},data:function(){return{swiperOption:{slidesPerView:3,spaceBetween:30,autoplay:{delay:3e3},breakpoints:{320:{slidesPerView:1,spaceBetween:20},768:{slidesPerView:2,spaceBetween:30},992:{slidesPerView:3,spaceBetween:30}}},isDisabled:!1,shops:[],memberFavorites:[],memberRoutes:[],memberRouteTitles:[],shopId:0,routeArr:[]}},inject:["emitter"],methods:{getShops:function(){var e=this,t="".concat("https://localhost:44333","/api/ShopInfoes");this.$http.get(t).then((function(t){e.shops=t.data.filter((function(e){return e.Click>10})),e.shops.forEach((function(t,s){e.shops[s].tags=t.TagIds.split(","),e.getShopScore(t.ShopID,s)}))})).catch((function(e){console.log(e)}))},getShopScore:function(e,t){var s=this,i="".concat("https://localhost:44333","/api/shopreviews/score/").concat(e);this.$http.get(i).then((function(e){s.shops[t].score=e.data})).catch((function(e){s.shops[t].score=e.response.data.Message,console.dir(e)}))},getMemberFavorites:function(){var e=this,t="".concat("https://localhost:44333","/api/MemberFavorites/").concat(this.memberId);this.$http.get(t).then((function(t){t.data.forEach((function(t){e.memberFavorites.includes(t.ShopID)||e.memberFavorites.push(t.ShopID)}))})).catch((function(e){console.dir(e)}))},getMember:function(){var e=document.cookie.replace(/(?:(?:^|.*;\s*)memberID\s*=\s*([^;]*).*$)|^.*$/,"$1");this.memberID=Number(e)},addFavorite:function(e){var t=this;if(this.memberId){var s="".concat("https://localhost:44333","/api/MemberFavorites"),i={MemberID:this.memberId,ShopID:e};this.$http.post(s,i).then((function(){t.memberFavorites.includes(e)||(t.memberFavorites.push(e),t.getMemberFavorites(),t.emitter.emit("push-message",{style:"success",title:"已加入我的最愛"}))})).catch((function(e){console.dir(e)}))}else this.$swal.fire({icon:"info",title:"請先登入",showCancelButton:!0,confirmButtonText:"登入",cancelButtonText:"關閉"}).then((function(e){e.isConfirmed&&t.$router.push("/memberlogin")}))},removeFavorite:function(e){var t=this,s="".concat("https://localhost:44333","/api/MemberFavorites/").concat(this.memberID,"/").concat(e);this.$http.delete(s).then((function(){t.memberFavorites.filter((function(s,i){(s==e||t.memberFavorites.includes(s.ShopID))&&t.memberFavorites.splice(i,1)})),t.getMemberFavorites(),t.emitter.emit("push-message",{style:"primary",title:"已從我的最愛中移除"})})).catch((function(e){console.dir(e)}))},addRoulette:function(e,t){this.routeArr=Object.keys(localStorage),localStorage.length>=12?this.showAlert():this.routeArr.includes("".concat(e))?this.emitter.emit("push-message",{style:"primary",title:"此店家已經有囉"}):(this.emitter.emit("push-message",{style:"success",title:"已加入隨機輪盤"}),localStorage.setItem(e,t),this.routeArr=Object.keys(localStorage))},openRouteModal:function(e){var t=this;this.memberId?(this.shopId=e,this.$emit("open-modal",this.shopId)):this.$swal.fire({icon:"info",title:"請先登入",showCancelButton:!0,confirmButtonText:"登入",cancelButtonText:"關閉"}).then((function(e){e.isConfirmed&&t.$router.push("/memberlogin")}))},getRoutes:function(){var e=this;this.memberRouteTitles=[];var t="".concat("https://localhost:44333","/api/Routes/").concat(this.memberID);this.$http.get(t).then((function(t){e.memberRoutes=t.data,e.memberRoutes.forEach((function(t){e.memberRouteTitles.push({title:t.Title,routeId:t.RouteID})}))})).catch((function(e){console.log(e)}))},showAlert:function(){this.$swal.fire({icon:"info",title:"最多只能加入 12 個項目"})}},mounted:function(){this.routeArr=Object.keys(localStorage),this.getShops(),this.getMember(),this.getMemberFavorites(),setTimeout((function(){}),1e3)}}),k=M,D=(s("d04e"),Object(f["a"])(k,y,I,!1,null,null,null)),S=D.exports,R=s("ac2a"),x={data:function(){return{isDisabled:!1,isMember:!1,memberName:"",review:{MemberID:0,Type:"",RContent:""},memberRoutes:[],memberRouteTitles:[],isLoading:!0,loader:{width:150,height:150,color:"#fff",lockScroll:!0,isFullPage:!0},shopId:0}},inject:["emitter"],components:{FrontNavbar:a["a"],FrontFooter:r["a"],LeafletComponent:w,Swiper:S,Roulette:C["a"],RouteModal:R["a"]},methods:{openRouletteModal:function(){this.$refs.modal.getPoints(),this.$refs.modal.init(),this.$refs.modal.drawRouletteWheel(),this.$refs.modal.openModal()},getMemberInfo:function(){var e=this;this.isLoading=!0;var t="".concat("https://localhost:44333","/api/MemberInfoes1/").concat(this.review.MemberID);this.$http.get(t).then((function(t){e.memberName=t.data[0].Name})).catch((function(e){console.dir(e)}))},addWebsiteReview:function(){var e=this;this.isDisabled=!0;var t="".concat("https://localhost:44333","/api/websitereview");this.$http.post(t,this.review).then((function(){e.review.Type="",e.review.RContent="",e.emitter.emit("push-message",{style:"success",title:"已送出，感謝您的留言"}),e.isDisabled=!1})).catch((function(e){console.dir(e)}))},gerMember:function(){var e=document.cookie.replace(/(?:(?:^|.*;\s*)memberToken\s*=\s*([^;]*).*$)|^.*$/,"$1");"true"===e?(this.isMember=!0,this.review.MemberID=document.cookie.replace(/(?:(?:^|.*;\s*)memberID\s*=\s*([^;]*).*$)|^.*$/,"$1"),this.getMemberInfo()):this.isMember=!1},openRouteModal:function(e){this.shopId=e,this.$refs.routeModal.openModal(),this.review.MemberID||(alert("請先登入"),this.$router.push("/memberlogin"))},getRoutes:function(){var e=this;this.memberRouteTitles=[];var t="".concat("https://localhost:44333","/api/Routes/").concat(this.review.MemberID);this.$http.get(t).then((function(t){e.memberRoutes=t.data,e.memberRoutes.forEach((function(t){e.memberRouteTitles.push({title:t.Title,routeId:t.RouteID})}))})).catch((function(e){console.log(e)}))}},mounted:function(){var e=this;this.gerMember(),this.getRoutes(),setTimeout((function(){e.isLoading=!1}),1e3)}},$=x,F=(s("3e0d"),Object(f["a"])($,i,o,!1,null,"338e6b6a",null));t["default"]=F.exports},d04e:function(e,t,s){"use strict";s("1971")}}]);
//# sourceMappingURL=chunk-3b000616.9581497e.js.map